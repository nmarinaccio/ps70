<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Week 4 — Microcontroller Programming</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css" />
  </head>

  <body>
    <!-- Nav/Header -->
    <header class="site-header">
      <div class="header-inner">
        <h1 class="site-title">Nate Marinaccio — PS70 Fall 2025</h1>

        <nav class="site-nav" aria-label="Primary">
          <ul class="nav-list">
            <li><a class="nav-btn" href="../index.html">Home</a></li>
            <li><a class="nav-btn" href="../about/about.html">About</a></li>
          </ul>
        </nav>
      </div>
      <div class="header-fade" aria-hidden="true"></div>
    </header>

    <main class="content">
      <!-- Title + Intro -->
      <section class="section">
        <h2 class="section-title">Microcontroller Programming</h2>
        <p class="section-body">
          For this week, we focused on microcontroller prorgramming. Using ESP-32 dev boards as our microcontroller of choice and ArduinoIDE as the IDE, we worked in class and lab to understand how we can use both digital and analog pins to make conditional logic for controlling LEDs, motors, and other downstream components. I really wanted to integrate this week’s project with my kenetic sculpture from last week. Overall, I decided to make a controller and a meter on the breadboard for the spinning speed.
        </p>
      </section>

      <!-- Specific Idea -->
      <section class="section">
        <h3 class="section-subtitle">The specific idea</h3>
        <p class="section-body">
          In class, we went over how to integrate the motor used for the kenetic sculptures with the ESP32. One interesting fact with this is that the microcontroller’s HIGH state is 3.3V, which is hardly enough to run the motor. Thus, we have to use a relay to control and link the motor to the 5V output on the microcontroller. This translates the 3.3V high to a 5V output. Additionally, the motor is either on or off. In order to control speeds, we discussed using Pulse Width Modulation (PWM) with a changing duty cycle (the percentage of time spent in the high state) to change the speed of the motor.
        </p>
        <p class="section-body mt-16">
          This brings us to the final design. Integrating with the motor relay, I added a potentiometer to return an analog value (between 3.3V and 0V). This value is taken as an input which then changes the duty cycle of the motor. Then, I added 3 LEDs to output pins connected to ground through a 300 ohm resistor.
        </p>

        <!-- Full-width diagram -->
        <figure class="media-frame wide mt-16">
          <img src="./circut_diagram.jpg" alt="Circuit diagram for ESP32, relay, potentiometer, and LEDs">
        </figure>
      </section>

      <!-- Challenges -->
      <section class="section">
        <h3 class="section-subtitle">Challenges</h3>
        <p class="section-body">
          As with any engineering project, this project did not go right for the first few times before finally getting it! There was a significant amount of debugging to be done. A majority of this debugging resulted in the fact that I am unfamiliar with the ESP32. I ended up using pins (including the Memory Pins and the TX pin) that should not be used on the ESP32. I started with a really complicated code file that made use of classes (because I had never used them before and I wanted to become familiar). This did not work. So, I removed all the mentions of classes. Did not work. Finally, I just started testing components individually. Only after I did that, I was able to rule out all of the components having issues (after a relay hot swap) except the board. Now, I thought the entire board was having an issue. However, Bobby helped me figure out that my specific pinout was causing issues.
        </p>

        <!-- Code images row -->
        <div class="image-row mt-16">
            <figure class="media-frame small">
            <img src="./classes.jpg" alt="Original code with classes">
            <figcaption class="media-caption">This is the original code that I wrote before even plugging in the ESP32. I was super optimistic and included classes.</figcaption>
            </figure>
        
            <figure class="media-frame small">
            <img src="./withoutClasses.jpg" alt="Code without classes">
            <figcaption class="media-caption">I then thought that after it didn’t work, it was because I added classes. I removed the mention of classes and tried again. It didn’t work.</figcaption>
            </figure>
        
            <figure class="media-frame small">
            <img src="./debugging.jpg" alt="Debugging process photo">
            <figcaption class="media-caption">After the code I knew should work didn’t, I started debugging.</figcaption>
            </figure>
        </div>
  

        <!-- Downloads row -->
        <div class="downloads-grid3 centered mt-16">
          <a class="btn-download" href="./classes.ino" download>Download: classes.ino</a>
          <a class="btn-download" href="./withoutClasses.ino" download>Download: withoutClasses.ino</a>
          <a class="btn-download" href="./debugging.ino" download>Download: debugging.ino</a>
        </div>
      </section>

      <!-- Final Product -->
      <section class="section">
        <h3 class="section-subtitle">Final product</h3>
        <p class="section-body">
          Finally, I was able to address the issue and upload the second code file (without classes) to test out the functionality after changing up the pins. And… it worked!!!
        </p>

        <!-- 3 images in a row: Green, Yellow, Red -->
        <div class="image-row mt-16">
            <figure class="media-frame small">
            <img src="./green.jpg" alt="Green LED state">
            </figure>
            <figure class="media-frame small">
            <img src="./yellow.jpg" alt="Yellow LED state">
            </figure>
            <figure class="media-frame small">
            <img src="./red.jpg" alt="Red LED state">
            </figure>
        </div>
  

        <p class="section-body mt-16">
          Overall, I am happy with how the project turned out. In the future, I would adjust the lighting system and duty cycle values to better match the color of lights (green being moving at an okay speed and red being too fast).
        </p>
      </section>
    </main>

    <footer class="site-footer">
      <p>© <span id="year"></span> Nate Marinaccio</p>
    </footer>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear();
    </script>
  </body>
</html>
